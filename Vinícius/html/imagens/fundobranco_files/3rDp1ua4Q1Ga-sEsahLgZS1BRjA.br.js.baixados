var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(o){if(e)throw new TypeError("Generator is already executing.");while(f&&(f=0,o[0]&&(r=0)),r)try{if(e=1,u&&(i=o[0]&2?u["return"]:o[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,o[1])).done)return i;(u=0,i)&&(o=[o[0]&2,i.value]);switch(o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++;u=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(o[0]===6&&r.label<i[1]){r.label=i[1];i=o;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(o);break}i[2]&&r.ops.pop();r.trys.pop();continue}o=t.call(n,r)}catch(s){o=[6,s];u=0}finally{e=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},e,u,i,f;return f={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f},__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},GlobalActionMenuV2Wrapper;(function(n){var t;(function(){function c(t,i){var r=i===null||i===void 0?void 0:i.querySelector(".".concat(f)),u,s;t.setAttribute(w,"");r&&(Lib.CssClass.add(r,"loading"),i.setAttribute(n,""),u=r.querySelector(".".concat(e)),u&&(Lib.CssClass.add(u,"b-hidden"),u.src=""),s=r===null||r===void 0?void 0:r.querySelector(".".concat(o)),s&&(s.style.backgroundImage=""))}function l(n){n&&i("/th?id=OBFB.107AF8B2FB79BD01FFDCABA4D756224A",n)}function d(n,t,i){var f,r,u;if(!n||!t)return null;if(f=window,typeof f.html2canvas=="function"){if(i)return i;if(r=n.getAttribute(b),u=r?_ge(r):null,u)return u}return l(t),null}function i(n,t){return new Promise(function(i,r){var s;if(!n){r("image url is empty");return}var u=t===null||t===void 0?void 0:t.querySelector(".".concat(f)),h=u===null||u===void 0?void 0:u.querySelector(".".concat(e)),c=u===null||u===void 0?void 0:u.querySelector(".".concat(o));if(!u||!h){r("lose HTMLElement");return}s=new Image;s.src=n;s.onerror=function(){r("load image error")};s.onload=function(){Lib.CssClass.remove(u,"loading");Lib.CssClass.remove(h,"b-hidden");h.src=n;c&&(c.style.backgroundImage="url(".concat(n,")"));i("render success")}})}function g(n,i){return new Promise(function(u,f){var e=window,o;typeof e.html2canvas=="function"?(o=Math.max(window.devicePixelRatio,1.1),e.html2canvas(n,{logging:!1,useCORS:!0,removeContainer:!1,scale:o,width:n.offsetWidth,height:n.offsetHeight,backgroundColor:Lib.CssClass.contains(i,"actionmenudark")?"#292827":"#fff",ignoreElements:function(n){return Lib.CssClass.contains(n,k)},onclone:function(n){var t=n.querySelectorAll("."+s);t&&t.forEach(function(n){n.style.display="block"})}}).then(function(f){var c,e=f.toDataURL("image/png",1),a;if(e.length<h)u(e),r(n),a={Size:(c=e.length)===null||c===void 0?void 0:c.toString()},t(i,"ScreenshotSuccessStandard",null,a);else{var v=h/e.length,o=Math.floor(f.width*v),s=Math.floor(f.height*v),l=new Image;l.src=e;l.onload=function(){var e,f=document.createElement("canvas"),h=f.getContext("2d"),c,a;f.width=o;f.height=s;h===null||h===void 0?void 0:h.drawImage(l,0,0,o,s);c=f.toDataURL("image/png",1);u(c);r(n);a={Width:o===null||o===void 0?void 0:o.toString(),Height:s===null||s===void 0?void 0:s.toString(),Size:(e=c.length)===null||e===void 0?void 0:e.toString()};t(i,"ScreenshotSuccessOversize",null,a)}}})["catch"](function(){f("get screenshot error");r(n)})):f("html2canvas load error")})}function r(n){var u=document.querySelector(".html2canvas-container"),i,t,r;for(u&&document.body.removeChild(u),i=n.contentDiv,t=i===null||i===void 0?void 0:i.querySelectorAll("."+s),r=0;r<(t===null||t===void 0?void 0:t.length);r++)t[r].remove()}function t(n,t,i,r){var o,u,s,c,h,e,f,l;if(i===void 0&&(i=null),r===void 0&&(r=null),o=typeof n=="string"?n:n===null||n===void 0?void 0:n.getAttribute("data-scenario"),Log&&Log.Log&&o){if(t="GAMV2."+t,u=["Namespace",nt(o),"Scenario",o],i&&(u.push("ShareType"),u.push(i)),r)for(f in r)r.hasOwnProperty(f)&&r[f]&&(u.push(f),u.push(r[f]));if(s=o.indexOf("Codex_")===0?"Codex":"CI",s==="Codex"){for(c=["Namespace"],h={},e=0;e<u.length&&e+1<u.length;e+=2)f=u[e],l=u[e+1],c.indexOf(f)===-1&&(h[f]=l);u.push("CustomData");u.push(JSON.stringify(h))}Log.Log.apply(Log,__spreadArray(["SystemEvent",s,t,!1],u,!1))}}function nt(n){switch(n){case"Vertical_RealEstate":return"Vertical_RealEstate";case"Codex_ConversationMode":return"Conversation";case"Codex_SemanticSerp":return"RightRail";case"Codex_CreatorMode":return"Creator";case"Codex_NotebookMode":return"Notebook";case"Codex_SunoAnswer":return"SunoAnswer";case"Codex_BicAnswer":return"BicAnswer";case"Codex_Others":return"Codex_Others";default:return"Others"}}function tt(r,u,f){return __awaiter(this,void 0,void 0,function(){var o,s,h,a,v,y,e;return __generator(this,function(w){switch(w.label){case 0:return(c(r,u),o=r.getAttribute(p),!o)?[3,2]:[4,i("/th?id=".concat(o),u)];case 1:return w.sent(),sj_evt.fire("GlobalActionMenuV2Wrapper:ScreenshotCompleted",r),[2];case 2:if(s=d(r,u,f),!s)return[3,7];u.setAttribute(n,"start");w.label=3;case 3:return w.trys.push([3,6,,7]),h=sb_gt(),[4,g(s,r)];case 4:return(a=w.sent(),v=sb_gt()-h,!u.getAttribute(n))?[2]:[4,i(a,u)];case 5:return w.sent(),u.setAttribute(n,"done"),e={ScreenshotTime:v.toString()},t(r,"ScreenshotPERF",null,e),[3,7];case 6:return y=w.sent(),e={ErrorMessage:y},t(r,"ScreenshotFailure",null,e),l(u),[3,7];case 7:return sj_evt.fire("GlobalActionMenuV2Wrapper:ScreenshotCompleted",r),[2]}})})}function a(n){var t=n[1],r=n[2],i;t&&(i=t.querySelector(".actionmenucontent"),i)&&tt(t,i,r)}function v(n){var t=n[1],r=n[2],i;t&&(i=t.querySelector(".actionmenucontent"),i)&&c(t,i)}function y(){u||(sj_evt.bind("GlobalActionMenuV2Wrapper.Screenshot",a,!0),sj_evt.bind("GlobalActionMenuV2Wrapper.ResetScreenshot",v,!0),u=!0)}function it(){sj_evt.unbind("GlobalActionMenuV2Wrapper.Screenshot",a);sj_evt.unbind("GlobalActionMenuV2Wrapper.ResetScreenshot",v);u=!1}function rt(){y()}function ut(){it()}var p="data-thumbnailid",w="data-s-thumbnailid",n="data-screenshotStatus",b="data-screenshotid",f="sreenshot-container",e="image-screenshot",o="background-image",k="data-html2canvas-ignore",s="data-html2canvas-hidden-element",h=2044e4,u=!1;y();sj_evt.bind("ajax.unload",ut);sj_evt.bind("ajax.postload",rt)})(t=n.Screenshot||(n.Screenshot={}))})(GlobalActionMenuV2Wrapper||(GlobalActionMenuV2Wrapper={}))