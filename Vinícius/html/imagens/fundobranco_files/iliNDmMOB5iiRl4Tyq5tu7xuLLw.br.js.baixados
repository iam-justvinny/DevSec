var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(o){if(e)throw new TypeError("Generator is already executing.");while(f&&(f=0,o[0]&&(r=0)),r)try{if(e=1,u&&(i=o[0]&2?u["return"]:o[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,o[1])).done)return i;(u=0,i)&&(o=[o[0]&2,i.value]);switch(o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++;u=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(o[0]===6&&r.label<i[1]){r.label=i[1];i=o;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(o);break}i[2]&&r.ops.pop();r.trys.pop();continue}o=t.call(n,r)}catch(s){o=[6,s];u=0}finally{e=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},e,u,i,f;return f={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f},__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},GlobalActionMenuV2Wrapper;(function(n){function yi(n,t){n&&t&&bi(n,t)}function ht(n,t){if(n&&t){if(ur(n,t),t.ElementToBindHoverEvent&&fr(n,t.ElementToBindHoverEvent),t.ElementForScreenshot&&er(n,t.ElementForScreenshot),t.CustomizedLoadingStatus==="Complete"&&lt(n),vr()){var i=vt()&&(t.PreviewThumbnailId||t.PreviewImageUrl);(t.ElementForPreview||i)&&sr(n,{element:t.ElementForPreview,imgTnid:t.PreviewThumbnailId,imgUrl:t.PreviewImageUrl})}sj_evt.fire(rt,n,t);r(n,"UpdateShareCommonControl")}}function p(i,u){var f,e,o,s,h;i&&i.getAttribute(a)!=="1"&&(f=t(i),f)&&(n.ShareCommonControlStore[f]=n.ShareCommonControlStore[f]||{},n.ShareCommonControlStore[f].shareCommonControlElement=i,u&&u.ElementToBindHoverEvent?n.ShareCommonControlStore[f].ElementToBindHoverEvent=u.ElementToBindHoverEvent:(e=i.getAttribute(d),e&&(o=_d.getElementById(e),o&&(n.ShareCommonControlStore[f].ElementToBindHoverEvent=o))),u&&u.ElementForScreenshot?n.ShareCommonControlStore[f].ElementForScreenshot=u.ElementForScreenshot:(s=i.getAttribute(l),s&&(h=_d.getElementById(s),h&&(n.ShareCommonControlStore[f].ElementForScreenshot=h))),(u===null||u===void 0?void 0:u.Close)&&(n.ShareCommonControlStore[f].onClose=u.Close),ki(i),sj_evt.fire("GlobalActionMenuV2Wrapper.InitShareActions",i),sj_evt.fire(rt,i,u),r(i,"InitShareCommonControl"),i.setAttribute(a,"1"))}function pi(n,i,r){if(n&&i){var u=t(n);u&&(r&&ht(n,r),i&&or(n,i),o(n,i,r))}}function wi(n){n&&s(n)}function bi(n,t){var f,e,i,u,o;if(n&&t&&typeof sj_ajax!="undefined"&&sj_ajax){f=["mousewheel","touchstart","touchmove","touchend"];f.forEach(function(t){n.addEventListener(t,function(n){n.stopPropagation()})});e=t.ScenarioNameUsedForLog?t.ScenarioNameUsedForLog:"Default_Default";r(e,"RenderShareCommonControl");i="";for(u in t)(typeof t[u]=="string"||typeof t[u]=="boolean")&&(i+="".concat(u,"=").concat(encodeURIComponent(t[u]),"&"));i&&(i="?"+i);o="/sharing/getsharecommoncontrol"+i;sj_ajax(o,{callback:function(i,u){if(i&&u){u.appendTo(n);var f=void 0,e=u.request.responseText.match(/data-menuid=(\"|\')([^\s\"\']+)(\"|\')/),o=(e===null||e===void 0?void 0:e.length)>=4?e[2]:"";if(!o)return;if(f=n.querySelector("span[".concat(v,'="').concat(o,'"]')),!f)return;r(f,"RenderShareCommonControlSuccess");p(f,t)}}})}}function ki(i){var r=t(i);r&&(di(i),(lr(i)||n.ShareCommonControlStore[r].ElementToBindHoverEvent)&&(nr(i),rr(i)))}function di(n){var t=i(n);sj_be(t,"keydown",function(t){return gi(t,n)})}function gi(n,t){var f,e,o,r,u;if(n&&n.key==="Tab"&&(r=document.activeElement,r&&r.nodeName==="CIB-SERP"&&(r=(f=r===null||r===void 0?void 0:r.shadowRoot)===null||f===void 0?void 0:f.activeElement,r&&r.nodeName==="CIB-HOVER"&&(r=(e=r===null||r===void 0?void 0:r.shadowRoot)===null||e===void 0?void 0:e.activeElement),r&&r.nodeName==="CIB-SHARE-DIALOG"&&(r=(o=r===null||r===void 0?void 0:r.shadowRoot)===null||o===void 0?void 0:o.activeElement)),u=i(t),u===null||u===void 0?void 0:u.contains(r))){var s=t.querySelectorAll("[tabindex='0']"),h=s[0],c=s[s.length-1];n.shiftKey?r.isEqualNode(h)&&(c.focus(),n.preventDefault()):r.isEqualNode(c)&&(h.focus(),n.preventDefault())}}function nr(i){var f=t(i),r,e,s,u;f&&(r=w(i),r&&(sj_be(r,"click",function(){return o(i,r)}),AccessibilityHelpers.activateButtonByKey(r,[13,32],function(){return o(i,r)})),e=Lib.CssClass.contains(i,ii),s=!e,s&&(u=n.ShareCommonControlStore[f].ElementToBindHoverEvent,u||(u=r),ct(i,u)))}function ct(i,r){var f,u,e,s;i&&r&&(f=t(i),f)&&(e=function(){u&&clearTimeout(u);u=setTimeout(function(){return o(i,r)},500)},s=function(){u&&(clearTimeout(u),u=null)},sj_be(r,"mouseenter",e),sj_be(r,"mouseleave",s),n.ShareCommonControlStore[f].onMouseEnter=e,n.ShareCommonControlStore[f].onMouseLeave=s)}function o(n,t,r){var u=i(n),s=Lib.CssClass.contains(t,h),o=Lib.CssClass.contains(u,f),l=!o&&Lib.CssClass.contains(u,c),a=o||l!=s;a&&(sj_evt.fire(e),tr(n,t),(r===null||r===void 0?void 0:r.CustomizedLoadingStatus)!=="Loading"&&lt(n))}function tr(n,t){var u=i(n),v,s,o,e,y,l,a;if(u){for(Lib.CssClass.add(n,k),v=Lib.CssClass.contains(t,h),v&&Lib.CssClass.add(u,c),Lib.CssClass.remove(u,b),Lib.CssClass.remove(u,f),s=u.getElementsByClassName(kt),o=0;o<s.length;o++)e=s[o],Lib.CssClass.remove(e,gt),Lib.CssClass.remove(e,ni),Lib.CssClass.add(e,dt),y=e.getElementsByClassName(ti),l=y[0],l&&(l.innerText="");ir(n,t,vi);a=cr(n);a&&a.focus();r(n,"OpenMenu");sj_evt.fire("GlobalActionMenuV2Wrapper:ActionMenuContentOpened",n)}}function ir(n,t,r){var u;if(n&&t&&n.getAttribute("data-disposamc")!=="true"&&(u=i(n),u)){var v=t.getBoundingClientRect(),o=t.offsetWidth?t.offsetWidth:0,s=t.offsetHeight?t.offsetHeight:0,e=v.left,h=_w.innerWidth-e-o,c=v.top,y=_w.innerHeight-c-s;u.style.position="fixed";e>h?e+o<r?(u.style.left="0",u.style.right=""):(u.style.left="",u.style.right=h+"px"):h+o<r?(u.style.left="",u.style.right="0"):(u.style.left=e+"px",u.style.right="");c>y?(u.style.top="",u.style.bottom=y+s+"px"):(u.style.top=c+s+"px",u.style.bottom="");var p=n.getBoundingClientRect(),f=u.getBoundingClientRect(),l=f.left-p.left,w=f.left,a=f.top-p.top,b=f.top;u.style.position="absolute";u.style.left=l+"px";u.style.top=a+"px";u.style.right="";u.style.bottom="";f=u.getBoundingClientRect();l+=w-f.left;a+=b-f.top;u.style.left=l+"px";u.style.top=a+"px"}}function lt(i){var r,u=t(i);u&&(((r=n.ShareCommonControlStore[u])===null||r===void 0?void 0:r.ElementForScreenshot)||i.getAttribute(l)||i.getAttribute(g)?setTimeout(function(){var t;return sj_evt.fire(ai,i,(t=n.ShareCommonControlStore[u])===null||t===void 0?void 0:t.ElementForScreenshot)},window.domtoimage?50:300):(sj_evt.fire("GlobalActionMenuV2Wrapper:ScreenshotSkipped",i),at(i)))}function rr(n){var t,r;sj_evt.bind(e,function(){return s(n)});sj_be(_d,"touchstart",function(){return sj_evt.fire(e)});sj_be(_d,"click",function(){return sj_evt.fire(e)});t=w(n);t&&(sj_be(t,"touchstart",function(n){return n.stopPropagation()}),sj_be(t,"click",function(n){return n.stopPropagation()}),AccessibilityHelpers.activateButtonByKey(t,[27],function(){return s(n)}));r=i(n);sj_be(r,"touchstart",function(n){return n.stopPropagation()});sj_be(r,"click",function(n){return n.stopPropagation()});AccessibilityHelpers.activateButtonByKey(r,[27],function(){return s(n)})}function s(u){var p,l,a,o=i(u),e,v,s,h,y;o&&!Lib.CssClass.contains(o,f)&&(sj_evt.fire("GlobalActionMenuV2Wrapper.ResetScreenshot",u,o),Lib.CssClass.add(o,f),Lib.CssClass.add(o,b),Lib.CssClass.remove(o,c),Lib.CssClass.remove(u,k),e=t(u),(l=(p=n.ShareCommonControlStore[e]).onClose)===null||l===void 0?void 0:l.call(p),v=(a=u.getElementsByClassName("share-preview-content"))===null||a===void 0?void 0:a[0],v&&(v.innerHTML=""),s=u.querySelector(ut),h=u.querySelector(ft),h===null||h===void 0?void 0:h.classList.remove(et),s===null||s===void 0?void 0:s.classList.add(ot),y=w(u),y?y.focus():e&&n.ShareCommonControlStore[e]&&n.ShareCommonControlStore[e].ElementToFocusAfterClose&&(n.ShareCommonControlStore[e].ElementToFocusAfterClose.focus(),n.ShareCommonControlStore[e].ElementToFocusAfterClose=null),r(u,"CloseMenu"),sj_evt.fire("GlobalActionMenuV2Wrapper:ActionMenuContentClosed",u))}function at(n){if(n){var u=n.querySelector(y),t=n.querySelector(ut),i=n.querySelector(ft);t&&i&&u&&(i.classList.add(et),t.classList.remove(ot),r(n,"dismissLoadingMask"),sj_evt.fire("GlobalActionMenuV2Wrapper:LoadingUIDismissed",n))}}function ur(n,t){var i,u,r;t.ScreenshotThumbnailId&&n.setAttribute(g,t.ScreenshotThumbnailId);t.DisplayMode&&n.setAttribute(fi,t.DisplayMode);t.ScenarioNameUsedForLog&&n.setAttribute(nt,t.ScenarioNameUsedForLog);i=hr(n);i&&(t.CustomizedTitle&&t.ShareDataSafetyHash&&(u=".share-title > span",r=n.querySelector(u),r&&(r.innerText=t.CustomizedTitle),i.setAttribute(hi,t.CustomizedTitle)),t.CustomizedContent&&t.ShareDataSafetyHash&&(i.setAttribute(ei,t.CustomizedContent),i.setAttribute(si,t.CustomizedContent),i.setAttribute(ci,t.CustomizedContent)),t.ScreenshotThumbnailId&&i.setAttribute(tt,t.ScreenshotThumbnailId),yr()&&t.CustomizedShareOutImageThumbnailId&&i.setAttribute(tt,t.CustomizedShareOutImageThumbnailId),t.ShareDataSafetyHash&&i.setAttribute(oi,t.ShareDataSafetyHash),t.UrlOverride&&i.setAttribute(li,t.UrlOverride))}function fr(i,r){var e,o,s,u,l,f,h,c;i&&r&&(u=t(i),u)&&(l=i.getAttribute(d),l)&&(f=(e=n.ShareCommonControlStore[u])===null||e===void 0?void 0:e.ElementToBindHoverEvent,f)&&(h=(o=n.ShareCommonControlStore[u])===null||o===void 0?void 0:o.onMouseEnter,h&&(sj_ue(f,"mouseenter",h),n.ShareCommonControlStore[u].onMouseEnter=null),c=(s=n.ShareCommonControlStore[u])===null||s===void 0?void 0:s.onMouseLeave,c&&(sj_ue(f,"mouseenter",c),n.ShareCommonControlStore[u].onMouseLeave=null),n.ShareCommonControlStore[u].ElementToBindHoverEvent=r,ct(i,r))}function er(i,r){var u,f;i&&r&&(u=t(i),u)&&(f=i.getAttribute(l),f)&&(n.ShareCommonControlStore[u].ElementForScreenshot=r)}function or(i,r){if(i&&r){var u=t(i);u&&(n.ShareCommonControlStore[u].ElementToFocusAfterClose=r)}}function sr(t,i){var f,e,r=(f=t.getElementsByClassName("share-preview-content"))===null||f===void 0?void 0:f[0],s,h;if(r){var a=i.element,c=i.imgTnid,v=i.imgUrl,u=a;if(vt())if(u)Lib.CssClass.remove(r,"img"),Lib.CssClass.add(r,"dom");else{var o=(e=n===null||n===void 0?void 0:n.Sharing)===null||e===void 0?void 0:e.sharingGlobalConfig,y=(o===null||o===void 0?void 0:o.thumbnailUrlFormat)||"https://www.bing.com/th?id={0}",l=c?Shared.formatString(y,c):v;if(!l)return;s=_d.createElement("img");s.src=l;u=s;Lib.CssClass.remove(r,"dom");Lib.CssClass.add(r,"img")}u&&(h=r.firstChild,h?r.replaceChild(u,h):r.appendChild(u),pr()&&AccessibilityHelpers.disableAllLinksInElementAsync(u))}}function hr(n){if(n!==null&&n!==void 0)return n.querySelector("."+ri)}function cr(n){if(n!==null&&n!==void 0)return n.querySelector("."+bt)}function i(n){if(n!==null&&n!==void 0)return n.querySelector("."+wt)}function w(n){if(n!==null&&n!==void 0)return n.querySelector("."+h)}function lr(n){if(n!==null&&n!==void 0)return n.querySelector("."+ui)}function t(n){return(n===null||n===void 0?void 0:n.getAttribute(v))||""}function r(n,t,i,r){var o=typeof n=="string"?n:n===null||n===void 0?void 0:n.getAttribute(nt),u,s,c,h,e,f,l;if(Log&&Log.Log&&o){if(t="GAMV2."+t,u=["Namespace",ar(o),"Scenario",o],i&&(u.push("ShareType"),u.push(i)),r)for(f in r)r.hasOwnProperty(f)&&r[f]&&(u.push(f),u.push(r[f]));if(s=o.indexOf("Codex_")===0?"Codex":"CI",s==="Codex"){for(c=["Namespace"],h={},e=0;e<u.length&&e+1<u.length;e+=2)f=u[e],l=u[e+1],c.indexOf(f)===-1&&(h[f]=l);u.push("CustomData");u.push(JSON.stringify(h))}Log.Log.apply(Log,__spreadArray(["SystemEvent",s,t,!1],u,!1))}}function ar(n){switch(n){case"Vertical_RealEstate":return"Vertical_RealEstate";case"Codex_ConversationMode":return"Conversation";case"Codex_SemanticSerp":return"RightRail";case"Codex_CreatorMode":return"Creator";case"Codex_NotebookMode":return"Notebook";case"Codex_SunoAnswer":return"SunoAnswer";case"Codex_BicAnswer":return"BicAnswer";case"Codex_Others":return"Codex_Others";default:return"Others"}}function vr(){return typeof _G!="undefined"&&_G.EF!==undefined&&_G.EF.sharepreview!==undefined&&_G.EF.sharepreview===1}function yr(){return typeof _G!="undefined"&&_G.EF!==undefined&&_G.EF.shareoutimage!==undefined&&_G.EF.shareoutimage===1}function vt(){return typeof _G!="undefined"&&_G.EF!==undefined&&_G.EF.sharepreviewthumbnailid!==undefined&&_G.EF.sharepreviewthumbnailid===1}function pr(){return typeof _G!="undefined"&&_G.EF!==undefined&&_G.EF.sharefixreadnum!==undefined&&_G.EF.sharefixreadnum===1}function yt(){var i,t;for(i in n.ShareCommonControlStore)n.ShareCommonControlStore.hasOwnProperty(i)&&(t=n.ShareCommonControlStore[i],t&&t.shareCommonControlElement&&(t.shareCommonControlElement.setAttribute(a,"0"),p(t.shareCommonControlElement)));sj_evt.unbind("ajax.postload",yt)}var pt=this,wt="actionmenucontent",bt="shareclosebtn",kt="ga_cpy_block",dt="ga_cpy_block_step0",gt="ga_cpy_block_step1",ni="ga_cpy_block_step2",ti="ga_cpy_title_step1",f="hiddenmenu",ii="actionmenumobile",b="nonemenu",k="openmenu",ri="b_sharedata",h="shareactionexp",c="sharemenu",ui="topactions",fi="data-displaymode",l="data-screenshotid",d="data-hoverid",a="data-initialized",v="data-menuid",g="data-thumbnailid",nt="data-scenario",ei="data-sd",oi="data-ht",si="data-im",hi="data-st",tt="data-oi",ci="data-tt",li="data-uo",it="GlobalActionMenuV2Wrapper.Binded",e="largeMenuDismiss",ai="GlobalActionMenuV2Wrapper.Screenshot",u="GlobalActionMenuV2Wrapper.Trigger",rt="GlobalActionMenuV2Wrapper:InitShareCopyUrl",y=".share-content-container",ut="".concat(y," > :first-child"),ft="".concat(y," > :last-child"),et="display-none",ot="content-disabled",vi=430,st=!1;n.ShareCommonControlStore=n&&n.ShareCommonControlStore||{};sj_evt.bind(it,function(){st=!0},!0);st||(sj_evt.fire(it),sj_evt.bind("GlobalActionMenuV2Wrapper.Create",function(n){var t=n[1],i=n[2];sj_evt.bind(u,function(){return yi(t,i)},!0)},!0),sj_evt.bind("GlobalActionMenuV2Wrapper.Update",function(n){var t=n[1],i=n[2];sj_evt.bind(u,function(){return ht(t,i)},!0)},!0),sj_evt.bind("GlobalActionMenuV2Wrapper.Init",function(n){var t,i;typeof n[1]=="string"?(i=n[1],t=_d.querySelector("span[".concat(v,'="').concat(i,'"]'))):t=n[1];sj_evt.bind(u,function(){return p(t)},!0)},!0),sj_evt.bind("GlobalActionMenuV2Wrapper.ShowActionMenuContent",function(n){var t=n[1],i=n[2],r=n[3];sj_evt.bind(u,function(){return pi(t,i,r)},!0)},!0),sj_evt.bind("GlobalActionMenuV2Wrapper.HideActionMenuContent",function(n){var t=n[1];sj_evt.bind(u,function(){return wi(t)},!0)},!0),sj_evt.bind("GlobalActionMenuV2Wrapper:ScreenshotCompleted",function(n){return __awaiter(pt,void 0,void 0,function(){var t;return __generator(this,function(){return(t=n[1],!t)?[2]:(at(t),[2])})})},!0));sj_evt.bind("ajax.postload",yt)})(GlobalActionMenuV2Wrapper||(GlobalActionMenuV2Wrapper={}))